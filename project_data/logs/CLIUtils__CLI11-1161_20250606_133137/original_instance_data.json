{
  "repo": "CLIUtils/CLI11",
  "pull_number": 1161,
  "instance_id": "CLIUtils__CLI11-1161",
  "issue_numbers": [
    "1156"
  ],
  "base_commit": "f6328ccc7a5dc3e8c64c68c1a6de445bab7f4725",
  "patch": "diff --git a/include/CLI/App.hpp b/include/CLI/App.hpp\nindex ffbe986fc..0e23a06c5 100644\n--- a/include/CLI/App.hpp\n+++ b/include/CLI/App.hpp\n@@ -733,6 +733,9 @@ class App {\n         auto *ptr = option_group.get();\n         // move to App_p for overload resolution on older gcc versions\n         App_p app_ptr = std::dynamic_pointer_cast<App>(option_group);\n+        // don't inherit the footer in option groups and clear the help flag by default\n+        app_ptr->footer_ = \"\";\n+        app_ptr->set_help_flag();\n         add_subcommand(std::move(app_ptr));\n         return ptr;\n     }\n",
  "test_patch": "diff --git a/tests/HelpTest.cpp b/tests/HelpTest.cpp\nindex 1ef795021..dcdebce6e 100644\n--- a/tests/HelpTest.cpp\n+++ b/tests/HelpTest.cpp\n@@ -85,6 +85,25 @@ TEST_CASE(\"THelp: FooterCallbackBoth\", \"[help]\") {\n     CHECK_THAT(help, Contains(\"foot!!!!\"));\n }\n \n+/// @brief from github issue #1156\n+TEST_CASE(\"THelp: FooterOptionGroup\", \"[help]\") {\n+    CLI::App app{\"My prog\"};\n+\n+    app.footer(\"Report bugs to bugs@example.com\");\n+\n+    app.add_option_group(\"group-a\", \"\");\n+\n+    app.add_option_group(\"group-b\", \"\");\n+\n+    std::string help = app.help();\n+\n+    auto footer_loc = help.find(\"bugs@example.com\");\n+    auto footer_loc2 = help.find(\"bugs@example.com\", footer_loc + 10);\n+    CHECK(footer_loc != std::string::npos);\n+    // should only see the footer once\n+    CHECK(footer_loc2 == std::string::npos);\n+}\n+\n TEST_CASE(\"THelp: OptionalPositional\", \"[help]\") {\n     CLI::App app{\"My prog\", \"program\"};\n \n",
  "problem_statement": "The new help formatter prints the footer and the help flag multiple times\nHello,\n\nIâ€™m experiencing an issue with the new help formatter #866. The help option and footer are being printed multiple times for each instance of an option group.\n\n```C++\n#include <CLI/CLI.hpp>\n\nint main(int argc, char **argv) {\n  CLI::App app;\n\n  app.footer(\"This used to appear only once at the bottom\");\n\n  auto group_a = app.add_option_group(\"group-a\", \"\");\n\n  auto group_b = app.add_option_group(\"group-b\", \"\");\n\n  try {\n    app.parse(argc, argv);\n\n  } catch (const CLI::ParseError &e) {\n    return app.exit(e);\n  }\n\n  return 0;\n}\n```\n\n> ./a --help\n\n```bash\nOPTIONS:\n  -h,     --help              Print this help message and exit \n[Option Group: group-a]\n  \nOPTIONS:\n  -h,     --help              Print this help message and exit \n\nThis used to appear only once at the bottom \n\n\n[Option Group: group-b]\n  \nOPTIONS:\n  -h,     --help              Print this help message and exit \n\nThis used to appear only once at the bottom \n\n\n\nThis used to appear only once at the bottom \n```\n\n\n",
  "hints_text": "",
  "created_at": "2025-05-07T12:42:54Z"
}